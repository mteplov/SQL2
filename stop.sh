#!/bin/bash

echo "======================================================"
echo "   ОСТАНОВКА И УДАЛЕНИЕ ПРОЕКТА ШАРДИРОВАНИЯ"
echo "======================================================"

PROJECT_DIR="sharding_project"
COMPOSE_FILE="$PROJECT_DIR/docker-compose.yml"

# ---------------------------------------
# 1. Остановка и удаление контейнеров
# ---------------------------------------
if [ -f "$COMPOSE_FILE" ]; then
    echo "[INFO] Останавливаем и удаляем контейнеры и тома..."
    docker compose -f $COMPOSE_FILE down -v
    echo "[OK] Контейнеры и тома удалены"
else
    echo "[INFO] docker-compose.yml не найден, контейнеры не удаляем"
fi

# ---------------------------------------
# 2. Удаление проектной папки
# ---------------------------------------
if [ -d "$PROJECT_DIR" ]; then
    echo "[INFO] Удаляем папку проекта $PROJECT_DIR..."
    rm -rf "$PROJECT_DIR"
    echo "[OK] Папка проекта удалена"
else
    echo "[INFO] Папка проекта не найдена, пропускаем"
fi

echo "======================================================"
echo "      ПРОЕКТ ШАРДИРОВАНИЯ ПОЛНОСТЬЮ ОСТАНОВЛЕН И УДАЛЕН"
echo "======================================================"

